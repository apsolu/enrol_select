{"version":3,"file":"select_mapping.min.js","sources":["../src/select_mapping.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module javascript.\n *\n * @todo       Description à compléter.\n *\n * @module     enrol_select/select_mapping\n * @copyright  2016 Université Rennes 2 <dsi-contact@univ-rennes2.fr>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'enrol_select/ol', 'enrol_select/jquery.popupoverlay'], function($, ol) {\n    return {\n        initialise: function() {\n            return; // Désactivé temporairement.\n\n            // Création de la map.\n            var map = new ol.Map({\n                layers: [\n                    new ol.layer.Tile({\n                        source: new ol.source.OSM()\n                    }),\n                    new ol.layer.Vector({\n                        source: new ol.source.Vector(),\n                        style: new ol.style.Style({\n                            image: new ol.style.Icon(/** @type {olx.style.IconOptions} */ ({\n                                anchor: [0.5, 46],\n                                anchorXUnits: 'fraction',\n                                anchorYUnits: 'pixels',\n                                opacity: 0.75,\n                                src: $('#apsolu-location-marker-img').attr('src')\n                            }))\n                        })\n                    })\n                ],\n                target: 'apsolu-location-map',\n                controls: ol.control.defaults({\n                        attributionOptions: /** @type {olx.control.AttributionOptions} */ ({\n                            collapsible: false\n                        })\n                    }).extend([\n                        new ol.control.FullScreen()\n                    ])\n            });\n\n            $('#apsolu-location-map').css('visilibity', 'hidden');\n            $('#apsolu-location-map').css('position', 'absolute');\n\n            // Lorsque l'utilisateur clique sur le marqueur de localisation...\n            $('.apsolu-location-markers-a').click(function(event) {\n                event.preventDefault();\n\n                var longitude = $(this).data('longitude');\n                var latitude = $(this).data('latitude');\n\n                map.setView(new ol.View({\n                    center: ol.proj.transform([longitude, latitude], 'EPSG:4326', 'EPSG:3857'),\n                    zoom: 13\n                }));\n\n                let layers = map.getLayers().getArray();\n                let source = layers[1].getSource();\n                source.clear();\n                source.addFeature(new ol.Feature({\n                    geometry: new ol.geom.Point(ol.proj.transform([longitude, latitude], 'EPSG:4326', 'EPSG:3857'))\n                }));\n\n                // Affiche l'overlay.\n                $('#apsolu-location-map').popup('show');\n\n                // Affiche la map.\n                $('#apsolu-location-map').css('visilibity', 'visible');\n                $('#apsolu-location-map').css('position', 'relative');\n            });\n        }\n    };\n});\n"],"names":["define","$","ol","initialise"],"mappings":";;;;;;;;;AAyBAA,qCAAO,CAAC,SAAU,kBAAmB,qCAAqC,SAASC,EAAGC,UAC3E,CACHC,WAAY"}