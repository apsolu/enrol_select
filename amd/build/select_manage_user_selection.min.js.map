{"version":3,"file":"select_manage_user_selection.min.js","sources":["../src/select_manage_user_selection.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module javascript.\n *\n * @todo       Description à compléter.\n *\n * @module     enrol_select/select_manage_user_selection\n * @copyright  2016 Université Rennes 2 <dsi-contact@univ-rennes2.fr>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'local_apsolu/table-mask'],\n    function($) {\n        return {\n            initialise: function(semester2) {\n                // Active les premiers sous-onglets (liste des acceptés, liste principale, liste complémentaire, etc).\n                $('.apsolu-manage-users-tab-ul > li:first-child > a').each(function() {\n                    $(this).addClass('active show');\n                    $(this).attr('aria-selected', 'true');\n                    $('#' + $(this).attr('aria-controls')).addClass('active show');\n                });\n\n                // Détermine quel onglet doit être actif au chargement de la page (S1 ou S2).\n                let index;\n                if (semester2 == true) {\n                    index = Math.floor($('#apsolu-manage-methods-title-tab-ul > li').length / 2);\n                } else {\n                    index = 0;\n                }\n\n                // Active un onglet (semestre 1, semestre 2, etc).\n                var $link = $('#apsolu-manage-methods-title-tab-ul > li').eq(index).children().first();\n                $link.addClass('active show');\n                $link.attr('aria-selected', 'true');\n                $('#' + $link.attr('aria-controls')).addClass('active show');\n\n                // Gère les checkboxes permettant de faire des actions sur les utilisateurs sélectionnés.\n                $('.select_options').change(function() {\n                    let $checkboxes = $(this).parents(':eq(1)').find(\"input[type='checkbox']:checked\");\n                    if ($checkboxes.length > 0 && $(this).val() !== '') {\n                        $(this).parents(':eq(1)').submit();\n                    }\n                });\n\n                // Gère les liens permettant de cocher toutes les checkboxes.\n                $('.checkall').click(function() {\n                    let $form = $(this).closest('.participants-form');\n                    $form.find(\"input[type='checkbox']\").prop('checked', true);\n                    $form.find('select[name=\"actions\"]').prop('disabled', false);\n                });\n\n                // Gère les liens permettant de décocher toutes les checkboxes.\n                $('.uncheckall').click(function() {\n                    let $form = $(this).closest('.participants-form');\n                    $form.find(\"input[type='checkbox']\").prop('checked', false);\n                    $form.find('select[name=\"actions\"]').prop('disabled', true);\n\n                });\n\n                // selectionne ou déselectionne toutes les checkboxes en fonction de l'état de la checkbox de selection globale\n                $('.change-all').change(function() {\n                    let $form = $(this).closest('.participants-form');\n                    let check = $(this).prop(\"checked\");\n                    $form.find(\"input[type='checkbox']\").prop('checked', check);\n                    $form.find('select[name=\"actions\"]').prop('disabled', !check);\n                });\n\n\n                // Active ou désactive le menu déroulant permettant de faire des actions sur les utilisateurs sélectionnés.\n                $('.apsolu-select-manage-users-input-checkbox').change(function() {\n                    let $form = $(this).closest('.participants-form');\n                    if ($form.find(\".apsolu-select-manage-users-input-checkbox:checked\").length == 0) {\n                        $form.find('select[name=\"actions\"],input[name=\"send_message\"]').prop('disabled', true);\n                    } else {\n                        $form.find('select[name=\"actions\"],input[name=\"send_message\"]').prop('disabled', false);\n                    }\n\n                    let check = $(this).prop(\"checked\");\n                    if(!check) {\n                        $form.find('.change-all').prop(\"checked\", false);\n                    } else if($form.find('.apsolu-select-manage-users-input-checkbox:not(:checked)').length == 0) {\n                        $form.find('.change-all').prop(\"checked\", true);\n                    }\n                });\n\n                // Désactive par défaut les menus déroulants permettant de faire des actions sur les utilisateurs sélectionnés.\n                $('select[name=\"actions\"]').prop('disabled', true);\n            }\n        };\n    }\n);\n"],"names":["define","$","initialise","semester2","index","each","this","addClass","attr","Math","floor","length","$link","eq","children","first","change","parents","find","val","submit","click","$form","closest","prop","check"],"mappings":";;;;;;;;;AAyBAA,mDAAO,CAAC,SAAU,4BACd,SAASC,SACE,CACHC,WAAY,SAASC,eASbC,MAPJH,EAAE,oDAAoDI,MAAK,WACvDJ,EAAEK,MAAMC,SAAS,eACjBN,EAAEK,MAAME,KAAK,gBAAiB,QAC9BP,EAAE,IAAMA,EAAEK,MAAME,KAAK,kBAAkBD,SAAS,kBAMhDH,MADa,GAAbD,UACQM,KAAKC,MAAMT,EAAE,4CAA4CU,OAAS,GAElE,MAIRC,MAAQX,EAAE,4CAA4CY,GAAGT,OAAOU,WAAWC,QAC/EH,MAAML,SAAS,eACfK,MAAMJ,KAAK,gBAAiB,QAC5BP,EAAE,IAAMW,MAAMJ,KAAK,kBAAkBD,SAAS,eAG9CN,EAAE,mBAAmBe,QAAO,WACNf,EAAEK,MAAMW,QAAQ,UAAUC,KAAK,kCACjCP,OAAS,GAAuB,KAAlBV,EAAEK,MAAMa,OAClClB,EAAEK,MAAMW,QAAQ,UAAUG,YAKlCnB,EAAE,aAAaoB,OAAM,eACbC,MAAQrB,EAAEK,MAAMiB,QAAQ,sBAC5BD,MAAMJ,KAAK,0BAA0BM,KAAK,WAAW,GACrDF,MAAMJ,KAAK,0BAA0BM,KAAK,YAAY,MAI1DvB,EAAE,eAAeoB,OAAM,eACfC,MAAQrB,EAAEK,MAAMiB,QAAQ,sBAC5BD,MAAMJ,KAAK,0BAA0BM,KAAK,WAAW,GACrDF,MAAMJ,KAAK,0BAA0BM,KAAK,YAAY,MAK1DvB,EAAE,eAAee,QAAO,eAChBM,MAAQrB,EAAEK,MAAMiB,QAAQ,sBACxBE,MAAQxB,EAAEK,MAAMkB,KAAK,WACzBF,MAAMJ,KAAK,0BAA0BM,KAAK,UAAWC,OACrDH,MAAMJ,KAAK,0BAA0BM,KAAK,YAAaC,UAK3DxB,EAAE,8CAA8Ce,QAAO,eAC/CM,MAAQrB,EAAEK,MAAMiB,QAAQ,sBACmD,GAA3ED,MAAMJ,KAAK,sDAAsDP,OACjEW,MAAMJ,KAAK,qDAAqDM,KAAK,YAAY,GAEjFF,MAAMJ,KAAK,qDAAqDM,KAAK,YAAY,GAGzEvB,EAAEK,MAAMkB,KAAK,WAGkE,GAAjFF,MAAMJ,KAAK,4DAA4DP,QAC7EW,MAAMJ,KAAK,eAAeM,KAAK,WAAW,GAF1CF,MAAMJ,KAAK,eAAeM,KAAK,WAAW,MAOlDvB,EAAE,0BAA0BuB,KAAK,YAAY"}