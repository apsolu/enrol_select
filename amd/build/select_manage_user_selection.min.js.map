{"version":3,"file":"select_manage_user_selection.min.js","sources":["../src/select_manage_user_selection.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module javascript.\n *\n * @todo       Description à compléter.\n *\n * @module     enrol_select/select_manage_user_selection\n * @copyright  2016 Université Rennes 2 <dsi-contact@univ-rennes2.fr>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'local_apsolu/table-mask'],\n    function($) {\n        return {\n            initialise: function(activeEnrolId) {\n                // Active les premiers sous-onglets (liste des acceptés, liste principale, liste complémentaire, etc).\n                $('.apsolu-manage-users-tab-ul > li:first-child > a').each(function() {\n                    $(this).addClass('active show');\n                    $(this).attr('aria-selected', 'true');\n                    $('#' + $(this).attr('aria-controls')).addClass('active show');\n                });\n\n                // Active un onglet (semestre 1, semestre 2, etc).\n                var $link = $('#apsolu-manage-methods-title-tab-ul > li a[aria-controls=\"enrol-' + activeEnrolId + '\"]');\n                $link.addClass('active show');\n                $link.attr('aria-selected', 'true');\n                $('#' + $link.attr('aria-controls')).addClass('active show');\n\n                // Gère les checkboxes permettant de faire des actions sur les utilisateurs sélectionnés.\n                $('.select_options').change(function() {\n                    let $checkboxes = $(this).parents(':eq(1)').find(\"input[type='checkbox']:checked\");\n                    if ($checkboxes.length > 0 && $(this).val() !== '') {\n                        $(this).parents(':eq(1)').submit();\n                    }\n                });\n\n                // Gère les liens permettant de cocher toutes les checkboxes.\n                $('.checkall').click(function() {\n                    let $form = $(this).closest('.participants-form');\n                    $form.find(\"input[type='checkbox']\").prop('checked', true);\n                    $form.find('select[name=\"actions\"]').prop('disabled', false);\n                });\n\n                // Gère les liens permettant de décocher toutes les checkboxes.\n                $('.uncheckall').click(function() {\n                    let $form = $(this).closest('.participants-form');\n                    $form.find(\"input[type='checkbox']\").prop('checked', false);\n                    $form.find('select[name=\"actions\"]').prop('disabled', true);\n\n                });\n\n                // selectionne ou déselectionne toutes les checkboxes en fonction de l'état de la checkbox de selection globale\n                $('.change-all').change(function() {\n                    let $form = $(this).closest('.participants-form');\n                    let check = $(this).prop(\"checked\");\n                    $form.find(\"input[type='checkbox']\").prop('checked', check);\n                    $form.find('select[name=\"actions\"]').prop('disabled', !check);\n                });\n\n\n                // Active ou désactive le menu déroulant permettant de faire des actions sur les utilisateurs sélectionnés.\n                $('.apsolu-select-manage-users-input-checkbox').change(function() {\n                    let $form = $(this).closest('.participants-form');\n                    if ($form.find(\".apsolu-select-manage-users-input-checkbox:checked\").length == 0) {\n                        $form.find('select[name=\"actions\"],input[name=\"send_message\"]').prop('disabled', true);\n                    } else {\n                        $form.find('select[name=\"actions\"],input[name=\"send_message\"]').prop('disabled', false);\n                    }\n\n                    let check = $(this).prop(\"checked\");\n                    if(!check) {\n                        $form.find('.change-all').prop(\"checked\", false);\n                    } else if($form.find('.apsolu-select-manage-users-input-checkbox:not(:checked)').length == 0) {\n                        $form.find('.change-all').prop(\"checked\", true);\n                    }\n                });\n\n                // Désactive par défaut les menus déroulants permettant de faire des actions sur les utilisateurs sélectionnés.\n                $('select[name=\"actions\"]').prop('disabled', true);\n            }\n        };\n    }\n);\n"],"names":["define","$","initialise","activeEnrolId","each","this","addClass","attr","$link","change","parents","find","length","val","submit","click","$form","closest","prop","check"],"mappings":";;;;;;;;;AAyBAA,mDAAO,CAAC,SAAU,4BACd,SAASC,SACE,CACHC,WAAY,SAASC,eAEjBF,EAAE,oDAAoDG,MAAK,WACvDH,EAAEI,MAAMC,SAAS,eACjBL,EAAEI,MAAME,KAAK,gBAAiB,QAC9BN,EAAE,IAAMA,EAAEI,MAAME,KAAK,kBAAkBD,SAAS,sBAIhDE,MAAQP,EAAE,mEAAqEE,cAAgB,MACnGK,MAAMF,SAAS,eACfE,MAAMD,KAAK,gBAAiB,QAC5BN,EAAE,IAAMO,MAAMD,KAAK,kBAAkBD,SAAS,eAG9CL,EAAE,mBAAmBQ,QAAO,WACNR,EAAEI,MAAMK,QAAQ,UAAUC,KAAK,kCACjCC,OAAS,GAAuB,KAAlBX,EAAEI,MAAMQ,OAClCZ,EAAEI,MAAMK,QAAQ,UAAUI,YAKlCb,EAAE,aAAac,OAAM,eACbC,MAAQf,EAAEI,MAAMY,QAAQ,sBAC5BD,MAAML,KAAK,0BAA0BO,KAAK,WAAW,GACrDF,MAAML,KAAK,0BAA0BO,KAAK,YAAY,MAI1DjB,EAAE,eAAec,OAAM,eACfC,MAAQf,EAAEI,MAAMY,QAAQ,sBAC5BD,MAAML,KAAK,0BAA0BO,KAAK,WAAW,GACrDF,MAAML,KAAK,0BAA0BO,KAAK,YAAY,MAK1DjB,EAAE,eAAeQ,QAAO,eAChBO,MAAQf,EAAEI,MAAMY,QAAQ,sBACxBE,MAAQlB,EAAEI,MAAMa,KAAK,WACzBF,MAAML,KAAK,0BAA0BO,KAAK,UAAWC,OACrDH,MAAML,KAAK,0BAA0BO,KAAK,YAAaC,UAK3DlB,EAAE,8CAA8CQ,QAAO,eAC/CO,MAAQf,EAAEI,MAAMY,QAAQ,sBACmD,GAA3ED,MAAML,KAAK,sDAAsDC,OACjEI,MAAML,KAAK,qDAAqDO,KAAK,YAAY,GAEjFF,MAAML,KAAK,qDAAqDO,KAAK,YAAY,GAGzEjB,EAAEI,MAAMa,KAAK,WAGkE,GAAjFF,MAAML,KAAK,4DAA4DC,QAC7EI,MAAML,KAAK,eAAeO,KAAK,WAAW,GAF1CF,MAAML,KAAK,eAAeO,KAAK,WAAW,MAOlDjB,EAAE,0BAA0BiB,KAAK,YAAY"}