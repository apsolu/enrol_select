{"version":3,"file":"overlay.min.js","sources":["../src/overlay.js"],"sourcesContent":["/**\n * @license \n * jQuery Tools @VERSION Overlay - Overlay base. Extend it.\n * \n * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.\n * \n * http://flowplayer.org/tools/overlay/\n *\n * Since: March 2008\n * Date: @DATE \n */\n\n// Ajout julien\n(function (factory) {\n\t// UMD start\n\t// https://github.com/umdjs/umd/blob/master/jqueryPluginCommonjs.js\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine(['jquery'], factory);\n\t} else if (typeof module === 'object' && module.exports) {\n\t\t// Node/CommonJS\n\t\tmodule.exports = function( root, jQuery ) {\n\t\t\tif ( jQuery === undefined ) {\n\t\t\t\t// require('jQuery') returns a factory that requires window to\n\t\t\t\t// build a jQuery instance, we normalize how we use modules\n\t\t\t\t// that require this pattern but the window provided is a noop\n\t\t\t\t// if it's defined (how jquery works)\n\t\t\t\tif ( typeof window !== 'undefined' ) {\n\t\t\t\t\tjQuery = require('jquery');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tjQuery = require('jquery')(root);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfactory(jQuery);\n\t\t\treturn jQuery;\n\t\t};\n\t} else {\n\t\t// Browser globals\n\t\tfactory(jQuery);\n\t}\n}// fin ajout julien\n\n(function($) { \n\n\t// static constructs\n\t$.tools = $.tools || {version: '@VERSION'};\n\t\n\t$.tools.overlay = {\n\t\t\n\t\taddEffect: function(name, loadFn, closeFn) {\n\t\t\teffects[name] = [loadFn, closeFn];\t\n\t\t},\n\t\n\t\tconf: {  \n\t\t\tclose: null,\t\n\t\t\tcloseOnClick: true,\n\t\t\tcloseOnEsc: true,\t\t\t\n\t\t\tcloseSpeed: 'fast',\n\t\t\teffect: 'default',\n\t\t\t\n\t\t\t// since 1.2. fixed positioning not supported by IE6\n\t\t\tfixed: !$.browser.msie || $.browser.version > 6, \n\t\t\t\n\t\t\tleft: 'center',\t\t\n\t\t\tload: false, // 1.2\n\t\t\tmask: null,  \n\t\t\toneInstance: true,\n\t\t\tspeed: 'normal',\n\t\t\ttarget: null, // target element to be overlayed. by default taken from [rel]\n\t\t\ttop: '10%'\n\t\t}\n\t};\n\n\t\n\tvar instances = [], effects = {};\n\t\t\n\t// the default effect. nice and easy!\n\t$.tools.overlay.addEffect('default', \n\t\t\n\t\t/* \n\t\t\tonLoad/onClose functions must be called otherwise none of the \n\t\t\tuser supplied callback methods won't be called\n\t\t*/\n\t\tfunction(pos, onLoad) {\n\t\t\t\n\t\t\tvar conf = this.getConf(),\n\t\t\t\t w = $(window);\t\t\t\t \n\t\t\t\t\n\t\t\tif (!conf.fixed)  {\n\t\t\t\tpos.top += w.scrollTop();\n\t\t\t\tpos.left += w.scrollLeft();\n\t\t\t} \n\t\t\t\t\n\t\t\tpos.position = conf.fixed ? 'fixed' : 'absolute';\n\t\t\tthis.getOverlay().css(pos).fadeIn(conf.speed, onLoad); \n\t\t\t\n\t\t}, function(onClose) {\n\t\t\tthis.getOverlay().fadeOut(this.getConf().closeSpeed, onClose); \t\t\t\n\t\t}\t\t\n\t);\t\t\n\n\t\n\tfunction Overlay(trigger, conf) {\t\t\n\t\t\n\t\t// private variables\n\t\tvar self = this,\n\t\t\t fire = trigger.add(self),\n\t\t\t w = $(window), \n\t\t\t closers,            \n\t\t\t overlay,\n\t\t\t opened,\n\t\t\t maskConf = $.tools.expose && (conf.mask || conf.expose),\n\t\t\t uid = Math.random().toString().slice(10);\t\t\n\t\t\n\t\t\t \n\t\t// mask configuration\n\t\tif (maskConf) {\t\t\t\n\t\t\tif (typeof maskConf == 'string') { maskConf = {color: maskConf}; }\n\t\t\tmaskConf.closeOnClick = maskConf.closeOnEsc = false;\n\t\t}\t\t\t \n\t\t \n\t\t// get overlay and trigger\n\t\tvar jq = conf.target || trigger.attr(\"rel\");\n\t\toverlay = jq ? $(jq) : null || trigger;\t\n\t\t\n\t\t// overlay not found. cannot continue\n\t\tif (!overlay.length) { throw \"Could not find Overlay: \" + jq; }\n\t\t\n\t\t// trigger's click event\n\t\tif (trigger && trigger.index(overlay) == -1) {\n\t\t\ttrigger.click(function(e) {\t\t\t\t\n\t\t\t\tself.load(e);\n\t\t\t\treturn e.preventDefault();\n\t\t\t});\n\t\t}   \t\t\t\n\t\t\n\t\t// API methods  \n\t\t$.extend(self, {\n\n\t\t\tload: function(e) {\n\t\t\t\t\n\t\t\t\t// can be opened only once\n\t\t\t\tif (self.isOpened()) { return self; }\n\t\t\t\t\n\t\t\t\t// find the effect\n\t\t \t\tvar eff = effects[conf.effect];\n\t\t \t\tif (!eff) { throw \"Overlay: cannot find effect : \\\"\" + conf.effect + \"\\\"\"; }\n\t\t\t\t\n\t\t\t\t// close other instances?\n\t\t\t\tif (conf.oneInstance) {\n\t\t\t\t\t$.each(instances, function() {\n\t\t\t\t\t\tthis.close(e);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// onBeforeLoad\n\t\t\t\te = e || $.Event();\n\t\t\t\te.type = \"onBeforeLoad\";\n\t\t\t\tfire.trigger(e);\t\t\t\t\n\t\t\t\tif (e.isDefaultPrevented()) { return self; }\t\t\t\t\n\n\t\t\t\t// opened\n\t\t\t\topened = true;\n\t\t\t\t\n\t\t\t\t// possible mask effect\n\t\t\t\tif (maskConf) { $(overlay).expose(maskConf); }\t\t\t\t\n\t\t\t\t\n\t\t\t\t// position & dimensions \n\t\t\t\tvar top = conf.top,\t\t\t\t\t\n\t\t\t\t\t left = conf.left,\n\t\t\t\t\t oWidth = overlay.outerWidth({margin:true}),\n\t\t\t\t\t oHeight = overlay.outerHeight({margin:true}); \n\t\t\t\t\n\t\t\t\tif (typeof top == 'string')  {\n\t\t\t\t\ttop = top == 'center' ? Math.max((w.height() - oHeight) / 2, 0) : \n\t\t\t\t\t\tparseInt(top, 10) / 100 * w.height();\t\t\t\n\t\t\t\t}\t\t\t\t\n\t\t\t\t\n\t\t\t\tif (left == 'center') { left = Math.max((w.width() - oWidth) / 2, 0); }\n\n\t\t\t\t\n\t\t \t\t// load effect  \t\t \t\t\n\t\t\t\teff[0].call(self, {top: top, left: left}, function() {\t\t\t\t\t\n\t\t\t\t\tif (opened) {\n\t\t\t\t\t\te.type = \"onLoad\";\n\t\t\t\t\t\tfire.trigger(e);\n\t\t\t\t\t}\n\t\t\t\t}); \t\t\t\t\n\n\t\t\t\t// mask.click closes overlay\n\t\t\t\tif (maskConf && conf.closeOnClick) {\n\t\t\t\t\t$.mask.getMask().one(\"click\", self.close); \n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// when window is clicked outside overlay, we close\n\t\t\t\tif (conf.closeOnClick) {\n\t\t\t\t\t$(document).on(\"click.\" + uid, function(e) { \n\t\t\t\t\t\tif (!$(e.target).parents(overlay).length) { \n\t\t\t\t\t\t\tself.close(e); \n\t\t\t\t\t\t}\n\t\t\t\t\t});\t\t\t\t\t\t\n\t\t\t\t}\t\t\t\t\t\t\n\t\t\t\n\t\t\t\t// keyboard::escape\n\t\t\t\tif (conf.closeOnEsc) { \n\n\t\t\t\t\t// one callback is enough if multiple instances are loaded simultaneously\n\t\t\t\t\t$(document).on(\"keydown.\" + uid, function(e) {\n\t\t\t\t\t\tif (e.keyCode == 27) { \n\t\t\t\t\t\t\tself.close(e);\t \n\t\t\t\t\t\t}\n\t\t\t\t\t});\t\t\t\n\t\t\t\t}\n\n\t\t\t\t\n\t\t\t\treturn self; \n\t\t\t}, \n\t\t\t\n\t\t\tclose: function(e) {\n\n\t\t\t\tif (!self.isOpened()) { return self; }\n\t\t\t\t\n\t\t\t\te = e || $.Event();\n\t\t\t\te.type = \"onBeforeClose\";\n\t\t\t\tfire.trigger(e);\t\t\t\t\n\t\t\t\tif (e.isDefaultPrevented()) { return; }\t\t\t\t\n\t\t\t\t\n\t\t\t\topened = false;\n\t\t\t\t\n\t\t\t\t// close effect\n\t\t\t\teffects[conf.effect][1].call(self, function() {\n\t\t\t\t\te.type = \"onClose\";\n\t\t\t\t\tfire.trigger(e); \n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// unbind the keyboard / clicking actions\n\t\t\t\t$(document).off(\"click.\" + uid + \" keydown.\" + uid);\t\t  \n\t\t\t\t\n\t\t\t\tif (maskConf) {\n\t\t\t\t\t$.mask.close();\t\t\n\t\t\t\t}\n\t\t\t\t \n\t\t\t\treturn self;\n\t\t\t}, \n\t\t\t\n\t\t\tgetOverlay: function() {\n\t\t\t\treturn overlay;\t\n\t\t\t},\n\t\t\t\n\t\t\tgetTrigger: function() {\n\t\t\t\treturn trigger;\t\n\t\t\t},\n\t\t\t\n\t\t\tgetClosers: function() {\n\t\t\t\treturn closers;\t\n\t\t\t},\t\t\t\n\n\t\t\tisOpened: function()  {\n\t\t\t\treturn opened;\n\t\t\t},\n\t\t\t\n\t\t\t// manipulate start, finish and speeds\n\t\t\tgetConf: function() {\n\t\t\t\treturn conf;\t\n\t\t\t}\t\t\t\n\t\t\t\n\t\t});\n\t\t\n\t\t// callbacks\t\n\t\t$.each(\"onBeforeLoad,onStart,onLoad,onBeforeClose,onClose\".split(\",\"), function(i, name) {\n\t\t\t\t\n\t\t\t// configuration\n\t\t\tif ($.isFunction(conf[name])) { \n\t\t\t\t$(self).on(name, conf[name]); \n\t\t\t}\n\n\t\t\t// API\n\t\t\tself[name] = function(fn) {\n\t\t\t\tif (fn) { $(self).on(name, fn); }\n\t\t\t\treturn self;\n\t\t\t};\n\t\t});\n\t\t\n\t\t// close button\n\t\tclosers = overlay.find(conf.close || \".close\");\t\t\n\t\t\n\t\tif (!closers.length && !conf.close) {\n\t\t\tclosers = $('<a class=\"close\"></a>');\n\t\t\toverlay.prepend(closers);\t\n\t\t}\t\t\n\t\t\n\t\tclosers.click(function(e) { \n\t\t\tself.close(e);  \n\t\t});\t\n\t\t\n\t\t// autoload\n\t\tif (conf.load) { self.load(); }\n\t\t\n\t}\n\t\n\t// jQuery plugin initialization\n\t$.fn.overlay = function(conf) {   \n\t\t\n\t\t// already constructed --> return API\n\t\tvar el = this.data(\"overlay\");\n\t\tif (el) { return el; }\t  \t\t \n\t\t\n\t\tif ($.isFunction(conf)) {\n\t\t\tconf = {onBeforeLoad: conf};\t\n\t\t}\n\n\t\tconf = $.extend(true, {}, $.tools.overlay.conf, conf);\n\t\t\n\t\tthis.each(function() {\t\t\n\t\t\tel = new Overlay($(this), conf);\n\t\t\tinstances.push(el);\n\t\t\t$(this).data(\"overlay\", el);\t\n\t\t});\n\t\t\n\t\treturn conf.api ? el: this;\t\t\n\t}; \n\t\n})); // suppression julien (jQuery);\n\n"],"names":["factory","$","tools","version","overlay","addEffect","name","loadFn","closeFn","effects","conf","close","closeOnClick","closeOnEsc","closeSpeed","effect","fixed","browser","msie","left","load","mask","oneInstance","speed","target","top","instances","Overlay","trigger","closers","opened","self","this","fire","add","w","window","maskConf","expose","uid","Math","random","toString","slice","color","jq","attr","length","index","click","e","preventDefault","extend","isOpened","eff","each","Event","type","isDefaultPrevented","oWidth","outerWidth","margin","oHeight","outerHeight","max","height","parseInt","width","call","getMask","one","document","on","parents","keyCode","off","getOverlay","getTrigger","getClosers","getConf","split","i","isFunction","fn","find","prepend","pos","onLoad","scrollTop","scrollLeft","position","css","fadeIn","onClose","fadeOut","el","data","onBeforeLoad","push","api","define","amd","module","exports","root","jQuery","undefined","require"],"mappings":"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"}